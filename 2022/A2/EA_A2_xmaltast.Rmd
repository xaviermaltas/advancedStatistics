---
title: "A2 - Anàlisi estadística I"
author: "Xavier Maltas Tarridas"
date: 'Novembre 2022'
output: 
  html_document:
    highlight: default
    number_sections: yes
    theme: cosmo
    toc: yes
    toc_depth: 2
    includes:
      in_header: RMD-header.html
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load_libraries, include=FALSE}
#Imports
library(knitr)
if (!require('plyr')) install.packages('plyr'); library('plyr')
if (!require('dplyr')) install.packages('dplyr'); library('dplyr')
if (!require('ggplot2')) install.packages('ggplot2'); library('ggplot2')
if (!require('gridExtra')) install.packages('gridExtra'); library('gridExtra')
if (!require('VIM')) install.packages('VIM'); library('VIM')
if (!require('fitdistrplus')) install.packages('fitdistrplus'); library('fitdistrplus')
```

******
# Lectura del fitxer
******

```{r, echo=TRUE}
#Load file
df <- read.csv("gpa_clean.csv", sep=",")
```


******
# Estadística descriptiva i visualització
******

## Anàlisi descriptiva

Seguidament, podem observar un sumari dels valors de les variables numèriques i categòriques.

```{r, echo=TRUE}
##DF descriptive analysis
#Dimensions
dim(df)
#df structure
str(df)
#Head data sample
head(df)
#Summary
summary(df)
#Class per each var
sapply(df,class)
```


## Visualització

### Distribucions individuals

#### Distribució de la variable _'sat'_

Visualització de la distribució de la variable _'sat'_.

```{r, echo=TRUE}
# sat distribution
ggplot( df, aes(x=sat)) +
  geom_histogram( aes(y=..density..), colour="black", fill="lightblue")+
  geom_density(alpha=.2, fill="indianred3") + 
  labs(title = "sat Distribution")
```



#### Distribució de la variable _'colgpa'_

Visualització de la distribució de la variable _'colgpa'_.

```{r, echo=TRUE}
#colgpa distribution

#discrete var creation
discrete.colgpa <- df$colgpa
#plot
ggplot( df, aes(x=discrete.colgpa)) +
  geom_histogram( aes(y=..density..), colour="black", fill="lightblue")+
  geom_density(alpha=.2, fill="indianred3") + 
  labs(title = "sat Distribution")
```

### Distribucions sobre _'sat'_

#### Distribució _'sat'_ per _'female'_


Visualització de la distribució de la variable _'sat'_ en funció del gènere, variable _'female'_.

```{r, echo=TRUE}
##sat-female
df.female <- df %>% filter(female == TRUE)
df.male <- df %>% filter(female == FALSE)
#female
satfemale.ggplot <- ggplot( df.female, aes(x=sat)) +
  geom_histogram( aes(y=..density..), colour="black", fill="lightblue")+
  geom_density(alpha=.2, fill="indianred3") + 
  labs(title = "sat Distribution Female")
satfemale.ggplot

#male
satmale.ggplot <- ggplot( df.male, aes(x=sat)) +
  geom_histogram( aes(y=..density..), colour="black", fill="lightblue")+
  geom_density(alpha=.2, fill="indianred3") + 
  labs(title = "sat Distribution Male")
satmale.ggplot

#ggplot grid
#grid.arrange(satfemale.ggplot, satmale.ggplot, ncol=2)

```

#### Distribució _'sat'_ per _'athlete'_


Visualització de la distribució de la variable _'sat'_ en funció de si és o no atleta.

```{r, echo=TRUE}
##sat-athlete
df.athletes <- df %>% filter(athlete == TRUE)
df.noathletes <- df %>% filter(athlete == FALSE)

#athletes
satAthletes.ggplot <- ggplot( df.athletes, aes(x=sat)) +
  geom_histogram( aes(y=..density..), colour="black", fill="lightblue")+
  geom_density(alpha=.2, fill="indianred3") + 
  labs(title = "sat Distribution Athletes")
satAthletes.ggplot

#no athletes
satNoathletes.ggplot <- ggplot( df.noathletes, aes(x=sat)) +
  geom_histogram( aes(y=..density..), colour="black", fill="lightblue")+
  geom_density(alpha=.2, fill="indianred3") + 
  labs(title = "sat Distribution No Athletes")
satNoathletes.ggplot
```

#### Distribució _'sat'_ segons raça


Visualització de la distribució de la variable _'sat'_ en funció de la raça.

```{r, echo=TRUE}
##sat-race
df.white <- df %>% filter(white == TRUE)
df.black <- df %>% filter(black == FALSE)
df.noRace <- df %>% filter(black ==FALSE & white == FALSE)
count(df.noRace)

#white
satWhite.ggplot <- ggplot( df.white, aes(x=sat)) +
  geom_histogram( aes(y=..density..), colour="black", fill="lightblue")+
  geom_density(alpha=.2, fill="indianred3") + 
  labs(title = "sat Distribution White")
satWhite.ggplot

#black
satBlack.ggplot <- ggplot( df.black, aes(x=sat)) +
  geom_histogram( aes(y=..density..), colour="black", fill="lightblue")+
  geom_density(alpha=.2, fill="indianred3") + 
  labs(title = "sat Distribution Black")
satBlack.ggplot

#no race
satNorace.ggplot <- ggplot( df.noRace, aes(x=sat)) +
  geom_histogram( aes(y=..density..), colour="black", fill="lightblue")+
  geom_density(alpha=.2, fill="indianred3") + 
  labs(title = "sat Distribution No Race")
satNorace.ggplot
```

### Distribucions sobre _'colgpa'_

#### Distribució _'colgpa'_ per _'female'_


Visualització de la distribució de la variable _'colgpa'_ en funció del gènere, variable _'female'_.

```{r, echo=TRUE}
##colgpa-female
#female
colgpafemale.ggplot <- ggplot( df.female, aes(x=colgpa)) +
  geom_histogram( aes(y=..density..), colour="black", fill="lightblue")+
  geom_density(alpha=.2, fill="indianred3") + 
  labs(title = "colgpa Distribution Female")
colgpafemale.ggplot

#male
colgpamale.ggplot <- ggplot( df.male, aes(x=colgpa)) +
  geom_histogram( aes(y=..density..), colour="black", fill="lightblue")+
  geom_density(alpha=.2, fill="indianred3") + 
  labs(title = "colgpa Distribution Male")
colgpamale.ggplot

#ggplot grid
#grid.arrange(colgpafemale.ggplot, colgpamale.ggplot, ncol=2)

```

#### Distribució _'colgpa'_ per _'athlete'_


Visualització de la distribució de la variable _'colgpa'_ en funció de si és o no atleta.

```{r, echo=TRUE}
##colgpa-athlete
#athletes
colgpaAthletes.ggplot <- ggplot( df.athletes, aes(x=colgpa)) +
  geom_histogram( aes(y=..density..), colour="black", fill="lightblue")+
  geom_density(alpha=.2, fill="indianred3") + 
  labs(title = "colgpa Distribution Athletes")
colgpaAthletes.ggplot

#no athletes
colgpaNoathletes.ggplot <- ggplot( df.noathletes, aes(x=colgpa)) +
  geom_histogram( aes(y=..density..), colour="black", fill="lightblue")+
  geom_density(alpha=.2, fill="indianred3") + 
  labs(title = "colgpa Distribution No Athletes")
colgpaNoathletes.ggplot
```

#### Distribució _'colgpa'_ segons raça


Visualització de la distribució de la variable _'colgpa'_ en funció de la raça.

```{r, echo=TRUE}
##colgpa-race
#white
colgpaWhite.ggplot <- ggplot( df.white, aes(x=colgpa)) +
  geom_histogram( aes(y=..density..), colour="black", fill="lightblue")+
  geom_density(alpha=.2, fill="indianred3") + 
  labs(title = "colgpa Distribution White")
colgpaWhite.ggplot

#black
colgpaBlack.ggplot <- ggplot( df.black, aes(x=colgpa)) +
  geom_histogram( aes(y=..density..), colour="black", fill="lightblue")+
  geom_density(alpha=.2, fill="indianred3") + 
  labs(title = "colgpa Distribution Black")
colgpaBlack.ggplot

#no race
colgpaNorace.ggplot <- ggplot( df.noRace, aes(x=colgpa)) +
  geom_histogram( aes(y=..density..), colour="black", fill="lightblue")+
  geom_density(alpha=.2, fill="indianred3") + 
  labs(title = "colgpa Distribution No Race")
colgpaNorace.ggplot
```


### Interpretació dels gràfics

Amb la visualització dels gràfics corresponents a les distribucions de les variables _'sat'_ i _'colgpa'_, podem observar que ambdues mostres un comportament que té una tendència simètrica, tot i que, en el cas de la variable _'sat'_ es veu molt millor reflectit que en cas de la variable _'colgpa'_.

Centrant-nos exclusivament en els gràfics corresponents a la variable _'sat'_, podem afirmar que la distribució seguida d'aquesta variable en funció del gènere és pràcticament igual en els dos casos, amb un punt central al voltant dels 1000 punts. En el cas d'anàlisi en si són o no atletes, observem un canvi de paradigma. En el cas dels alumnes que són atletes, la distribució dels valors és molt més dispersa. Trobem més registres amb valors baixos de forma més freqüent i amb un punt central també més baix del vist en el gràfic dels alumnes que no són atletes. Finalment, si ens centrem en els valors segons la raça, podem veure una distribució pràcticament calcada tant si aquests són blancs com si són negres. Pel que fa als valors corresponents a les persones que no pertanyen a cap dels grups esmentats anteriorment, la distribució és molt dispersa com a conseqüència per la poca quantitat de registres que trobem en aquest cas concret.

Si ens fixem en la nota mitjana del primer semestre, variable _'colpga'_, en funció del gènere; podem veure que el punt central en el cas de les dones està situat sobre un valor major respecte al dels homes. Com a tal podem afirmar que durant aquest primer semestre les notes de forma mitjana tendeixen a ser superior per les dones. Si realitzem la comparativa en funció dels alumnes que són i no són atletes, observem que la valoració dels que no ho són, tendeix a ser superior, ja que principalment els valors es troben en un rang al voltant dels 3 punts, mentre que en el cas dels atletes, al voltant dels 2 punts. Finalment, si ens centrem en els valors segons la raça, podem veure una distribució pràcticament calcada tant si aquests són blancs com si són negres. Pel que fa als valors corresponents a les persones que no pertanyen a cap dels grups esmentats anteriorment, la distribució és molt dispersa com a conseqüència per la poca quantitat de registres que trobem en aquest cas concret.



******
# Interval de confiança de la mitjana poblacional de la variable _'sat'_ i _'colpga'_
******

## Supòsits

### _'sat'_

```{r, echo=TRUE}
#summary
summary(df$sat)

#metrics table
idx <- c("sat","colgpa")
mean <- as.vector(sapply(df[,idx], mean, na.rm=TRUE))
sd <- as.vector(sapply(df[,idx], sd, na.rm=TRUE))
median <- as.vector(sapply(df[,idx], median, na.rm=TRUE))
IQR <- as.vector(sapply(df[,idx],IQR, na.rm=TRUE))

#table creation
table.satcolgpa <- kable(data.frame(Variables=names(df[idx]),
                                Mean = mean,
                                StandardDeviation = sd,
                                Median = median,
                                IQR = IQR),digits=2, caption="Table")
table.satcolgpa


#sat Box plot
boxplot(df$sat, main="Sat Boxplot Distribution")

```

Observant les mètriques i gràfics podem suposar que el valor mitjà poblacional de la variable _'sat'_ es trobarà entre els valors 1000 i 1050.

### _'colgpa'_

```{r, echo=TRUE}
#summary
summary(df$colgpa)

#metrics table
idx <- c("sat","colgpa")
mean <- as.vector(sapply(df[,idx], mean, na.rm=TRUE))
sd <- as.vector(sapply(df[,idx], sd, na.rm=TRUE))
median <- as.vector(sapply(df[,idx], median, na.rm=TRUE))
IQR <- as.vector(sapply(df[,idx],IQR, na.rm=TRUE))

#table creation
table.satcolgpa <- kable(data.frame(Variables=names(df[idx]),
                                Mean = mean,
                                StandardDeviation = sd,
                                Median = median,
                                IQR = IQR),digits=2, caption="Table")
table.satcolgpa

#colgpa Box plot
boxplot(df$colgpa, main="Colgp Boxplot Distribution")
```

Observant les mètriques i gràfics podem suposar que el valor mitjà poblacional de la variable _'colgpa'_ es trobarà entre els valors 2.45 i 2.75.

## Funció de càlcul de l’interval de confiança

A continuació realitzem una funció anomenada IC que donat un vector de dades (x) i un nivell de confiança (NC), retorni els intervals de confiança de la mostra.

```{r, echo=TRUE}

IC <- function(x, NC) {
  n <- length(x)
  mean <- mean(x)
  sd <- sd(x)
  z <- abs(qnorm(((1-NC)/2)))
  errorst <- sd/sqrt(n)
  lim_inf <- mean - (z*errorst)
  lim_sup <- mean + (z*errorst)
  output <- data.frame(NC, n, mean, sd, z, errorst, lim_inf, lim_sup)
  return(output)
}

```

## Interval de confiança de la variable _'sat'_

Calculem els intervals de confiança de la variable _'sat'_ mitjançant la funció creada a l’apartat anterior. A la vegada, realitzem la comprovació del correcte funcionament de la nostra funció mitjançant la qual disposa R anomenada t.test.

```{r, echo=TRUE}
#Intervals de confinaça
ic95.sat <- IC(df$sat, 0.95)
ic95.sat
ic90.sat <- IC(df$sat, 0.90)
ic90.sat

#t.test
t.test(df$sat, conf.level = 0.95)
t.test(df$sat, conf.level = 0.90)
```

Observem que els resultats obtinguts d'ambdues funcions ens donen els mateixos intervals de confiança final en els dos casos. 

## Interval de confiança de la variable _'colgpa'_

Realitzarem el mateix procés per la variable _'colgpa'_. Còmput dels intervals de confiança i comprovació mitjançant t.test.

```{r, echo=TRUE}
#Intervals de confinaça
ic95.colgpa <- IC(df$colgpa, 0.95)
ic95.colgpa
ic90.colgpa <- IC(df$colgpa, 0.90)
ic90.colgpa

#t.test
t.test(df$colgpa, conf.level = 0.95)
t.test(df$colgpa, conf.level = 0.90)
```

Observem que els resultats obtinguts d'ambdues funcions ens donen els mateixos intervals de confiança final en els dos casos. 

## Interpretació

A l'hora d'interpretar els intervals de confiança obtinguts, podem concloure que si realitzem un mostreig amb quantitat elevada de mostres de la població, el percentatge (NC) dels intervals de confiança que hàgim obtingut d'aquestes mostres, contindran el valor de la mitjana poblacional.
Per tant, en el cas de la variable _'sat'_, el 95% dels valors aconseguits de la mostra, es trobaran continguts dins l'interval de confiança [1026.083, 1034.579].



******
# Ser atleta influeix a la nota?
******

## Anàlisi visual

Realitzem un petit anàlisi visual per tal d'orientar la pregunta.

```{r, echo=TRUE}
#colgpa ath-noAth density ggplot
colgpaAthNotath.ggplot <- ggplot() +
  geom_density(aes(x = df.athletes$colgpa, color = 'Athletes'), alpha=.5, fill="indianred3") +
  geom_density(aes(x = df.noathletes$colgpa, color = 'No Athletes'), alpha=.5, fill="lightblue") +
  xlab("colgpa") + ylab("Density") + ggtitle('colgpa Distribution Athletes-No athletes') +
  theme(legend.position = 'right') +
  scale_color_manual(values = c('Athletes' = 'red', 'No Athletes' = 'blue'))
colgpaAthNotath.ggplot
```

Observem que hi ha una diferència en la distribució entre els alumnes que són atletes respecte a aquells que no ho són. Els alumnes que són atletes concentren la variable _'colgpa'_ sobre la zona del valor 2, mentre que aquells que no són atletes ho fan sobre la zona del valor 3.

## Funció per al contrast de mitjanes

```{r, echo=TRUE}

tTest <- function( x1, x2, halternativa="twosided", C=95 ){
  
  mean1 <- mean(x1)
  mean2 <- mean(x2)
  n1 <- length(x1)
  n2 <- length(x2)
  sd1 <- sd(x1)
  sd2 <- sd(x2)
  alfa <- (1-C/100)
  
  #src: https://www.investopedia.com/terms/t/t-test.asp#:~:text=two%20sample%20sets.-,T%2DScore,validity%20of%20the%20null%20hypothesis.
  degreefreedom <- ( (sd1**2/n1 + sd2**2/n2)**2 ) / ( (sd1**2/n1)**2/(n1-1) + (sd2**2/n2)**2/(n2-1))
  t <- (mean1-mean2) / (sqrt( sd1**2/n1 + sd2**2/n2 ))
  
  if (halternativa=="twosided"){
    tcritical <- qt( alfa/2, degreefreedom, lower.tail=FALSE ) 
    pvalue <- pt( abs(t), degreefreedom, lower.tail=FALSE )*2 
  }
  else if (halternativa=="<"){
    tcritical <- qt( alfa, degreefreedom, lower.tail=TRUE )
    pvalue <- pt( t, degreefreedom, lower.tail=TRUE )
  }
  else{ #">"
    tcritical <- qt( alfa, degreefreedom, lower.tail=FALSE )
    pvalue <- pt( t, degreefreedom, lower.tail=FALSE )
  }
  #Resultat en un named vector
  output <- c(alfa, mean1, mean2, t, tcritical, pvalue)
  names(output) <- c("alfa", "mean1", "mean2", "t", "tcritical", "pvalue")
  return (output)
}


```

## Pregunta de recerca

La nota mitjana poblacional _'colgpa'_ dels alumnes que són atletes és inferior a la nota mitjana poblacional _'colgpa'_ de la resta d'alumnes?

## Hipòtesi nul·la i l'alternativa

Un cop formulada la pregunta que desitgem respondre, cal determinar la hipòtesi nul·la i la hipòtesi alternativa.

$$
H_0: \mu_{Athletes} = \mu_{Other}
$$
$$
H_1:  \mu_{Athletes} < \mu_{Other}
$$
La hipòtesi nul·la representa allò que desitgem provar, mentre que la hipòtesi alternativa, representa l'alternativa que oferim respecte a la hipòtesi nul·la. 

## Justificació del test a aplicar

Per saber quin tipus de test podem aplicar per resoldre la hipòtesi plantejada i les característiques de la mostra, hem de realitzar un petit estudi sobre el conjunt de dades.

```{r, echo=TRUE}
#New colgpa ath-no ath df
df.athletes.colgpa <- df.athletes$colgpa
df.noathletes.colgpa <- df.noathletes$colgpa

## Atheltes
df.athletes.nrow <- nrow(df.athletes)
print(paste("Athletes is a ", (df.athletes.nrow/(nrow(df))) *100, "% of the set"))
pie(table(df$athlete), main="Athletes-No athletes Pie Plot",labels = c("No Athletes","Athletes"))

#athletes norm
fit.norm.athletes.colgpa <- fitdist(df.athletes.colgpa, "norm")
denscomp(fit.norm.athletes.colgpa, main= "Histogram and theoretical densities - Athletes")

#No atheltes
#No athletes norm
fit.norm.noathletes.colgpa <- fitdist(df.noathletes.colgpa, "norm")
denscomp(fit.norm.noathletes.colgpa, main= "Histogram and theoretical densities - No athletes")


```

Estem realitzant un test de dues mostres sobre la mitjana de variàncies desconegudes, és per aquest motiu que aplicant el teorema del límit central (TLC) podem assumir normalitat, ja que tal com ens indica el TLC, la mitjana d'una mostra de mida gran (mostra superior a 30 registres) es comporta com una distribució normal. Hi ha un matís a tenir en compte i és que desconeixem la variància de la població i per tant haurem de fer servir la variància mostral com a aproximació. En aquest cas, haurem d'aplicar la distribucio t de Student amb n-1 graus de llibertat. En funcions pràctiques, com que les mostres són grans, la distribució t de Student es comporta de forma similar a la distribució normal.

## Càlcul

Aplicarem la funció _tTest_ creada anteriorment i realitzarem una comprovació amb els la funció de R _t.test_.

```{r, echo=TRUE}
ttest.athNoAth.colgpa.95<-tTest( df.athletes.colgpa, df.noathletes.colgpa, "<", 95); ttest.athNoAth.colgpa.95
t.test( df.athletes.colgpa, df.noathletes.colgpa, alternative="less", conf.level=0.95)
```

## Interpretació del test

El _p valor_ és una xifra que oscil·la entre 0 i 1, i que correspon a la probabilitat estadística que un valor sigui possible donat que la hipòtesi nul·la sigui certa. Aquest indicador, en cas de ser petit, indicarà que el valor de l'estadístic de contrast que hem observat tenia una probabilitat petita de sortir sota la hipòtesi nul·la i, per tant, rebutgem la hipòtesi nul·la. Per altra banda, en cas de ser gran, indicarà que era un valor bastant probable sota la hipòtesi nul·la i, en conseqüència, té sentit acceptar la hipòtesi nul·la.
En el cas que ens ocupa, el valor p del test és molt petit. És per aquest motiu que, hem de refusar la hipòtesi nul·la, com a tal podem afirmar que la nota mitjana poblacional _'colgpa'_ dels atletes, és inferior a la resta dels altres alumnes.



******
#  Les dones tenen millor nota que els homes?
******
## Anàlisi visual

Realitzem un petit anàlisi visual per tal d’orientar la pregunta.

```{r, echo=TRUE}
#colgpa female-male density ggplot
colgpaFemaleMale.ggplot <- ggplot() +
  geom_density(aes(x = df.female$colgpa, color = 'Female'), alpha=.5, fill="indianred3") +
  geom_density(aes(x = df.male$colgpa, color = 'Male'), alpha=.5, fill="lightblue") +
  xlab("colgpa") + ylab("Density") + ggtitle('colgpa Distribution Female-Male') +
  theme(legend.position = 'right') +
  scale_color_manual(values = c('Female' = 'red', 'Male' = 'blue'))
colgpaFemaleMale.ggplot


#Densities comparation - real and theoretical
df.female.colgpa <- df.female$colgpa
df.female.nrow <- nrow(df.female); df.female.nrow

df.male.colgpa <-df.male$colgpa
df.male.nrow <- nrow(df.male); df.male.nrow

#Female
fit.norm.female.colgpa <- fitdist(df.female.colgpa, "norm")
denscomp(fit.norm.female.colgpa, main= "Histogram and theoretical densities - Female")

#Male
fit.norm.male.colgpa <- fitdist(df.male.colgpa, "norm")
denscomp(fit.norm.male.colgpa, main= "Histogram and theoretical densities - Male")
```

Observem que la distribució de les dues mostres són molt similars amb una tendènia simètrica en els dos casos. En el cas de les dones el valor central de la variable _'colgpa'_ es troba sobre el valor 2.75 mentre que en el cas dels homes sobre el 2.25.

## Funció

Es farà servir la funció realitzada a l'apartat 4.2. Justificació a l'apartat 5.5.

## Pregunta de recerca

La nota mitjana poblacional ‘colgpa’ dels alumnes que són dones és superior a la nota mitjana poblacional ‘colgpa’ dels alumnes homes?

## Hipòtesi nul·la i l'alternativa


Un cop formulada la pregunta que desitgem respondre, cal determinar la hipòtesi nul·la i la hipòtesi alternativa.

$$
H_0: \mu_{Female} = \mu_{Male}
$$
$$
H_1:  \mu_{Female} > \mu_{Male}
$$


## Justificació del test a aplicar

A través de l'anàlisi visual que hem realitzat anteriorment, podem observar que disposem de dues distribucions de tendència simètrica. A la vegada, aquesta mostra pot ser considerada com a una mostra de mida gran donat el nombre de registres que disposem en els dos casos. Mitjançant l'aplicació del teorema del límit central, per una mostra de mida gran, aquesta es comporta com a una distribució normal. Per dur a terme la comprovació total d'aquest fet, hem comparat la distribució de cada una de les dues mostres (female i male) amb la distribució de densitat teòrica d'una distribució de tipus normal, i veiem en els dos casos encaixa de forma bastant precisa. Així doncs, estaríem parlant de dues distribucions de tipus normal.
El test aplicat a la secció anterior, hem utilitzat la funció _qt_, ja que havíem tingut en compte que treballàvem sobre una distribució t de Student. En el cas actual hauríem de fer servir _qnorm_, que ens entrega el quantil d'una distribució de tipus normal especificant una densitat acumulada concreta. Tot i això, la diferència dels resultats obtinguts amb la funció _qt_ respecte _qnorm_, serien molt similars, és per aquest motiu que s'acceptaria fer servir _qt_ en lloc de _qnorm_, i com a tal, útil la funció anterior pel cas actual.

## Càlcul

Aplicarem la funció _tTest_ creada anteriorment i realitzarem una comprovació amb els la funció de R _t.test_.

```{r, echo=TRUE}
ttest.femaleMale.colgpa.95<-tTest( df.female.colgpa, df.male.colgpa, ">", 95); ttest.femaleMale.colgpa.95
t.test( df.female.colgpa, df.male.colgpa, alternative="greater", conf.level=0.95)
```

## Interpretació del test

Observant els resultats obtinguts en el càlcul del test a l'apartat anterior, podem visualitzar que el valor p és molt petit i inferior al nivell de significació. És per aquest motiu, que hem de refusar la hipòtesi nul·la. Per tant, afirmar que la hipòtesi alternativa és certa. La nota mitjana poblacional _'colgpa'_ de les alumnes dones és superior al dels alumnes homes.

******
#  Hi ha diferències a la nota segons la raça?
******
## Anàlisi visual
## Funció
## Pregunta de recerca
## Hipòtesi nul·la i l'alternativa
## Justificació del test a aplicar
## Càlcul
## Interpretació del test


******
#  Proporció d’atletes
******
## Anàlisi visual
## Funció
## Pregunta de recerca
## Hipòtesi nul·la i l'alternativa
## Justificació del test a aplicar
## Càlcul
## Interpretació del test

******
#  Hi ha més atletes entre els homes que entre les dones?
******
## Anàlisi visual
## Funció
## Pregunta de recerca
## Hipòtesi nul·la i l'alternativa
## Justificació del test a aplicar
## Càlcul
## Interpretació del test